/*! weimob_vshop_admin
*author:<a.b.c@hd3p.com> */
define("dist/category/init",["$","dist/application/app"],function(a){"use strict";{var b=a("$"),c=a("dist/application/app"),d=c.config;c.method}b(".js-btn").addClass("hide"),b(document).on("mouseover",".js-active",function(){b(this).find(".js-btn").removeClass("hide")}),b(document).on("mouseout",".js-active",function(){b(this).find(".js-btn").addClass("hide")}),b(document).on("click",".js_set_valid",function(a){a.preventDefault();var c,e=b(this),f=e.data("remote"),g=e.closest("tr").find(".js_id").text(),h=e.closest("tr").find(".text-info").text();console.log(g),c="确定设置类目：@"+h+"为有效？";var i=function(){b.post(f,{id:g}).done(function(a){d.issucceed(a)?(d.msg.suc(a.message),window.location.reload()):d.msg.error(a.message)}).fail(function(){d.msg.info(d.lang.exception)})};d.msg.msgbox.confirm(c,function(a){a&&i()})}),b(document).on("click",".js_set_invalid",function(a){a.preventDefault();var c,e=b(this),f=e.data("remote"),g=e.data("valid"),h=e.closest("tr").find(".js_id").text(),i=e.closest("tr").find(".text-info").text(),j=function(){b.post(g,{id:h}).done(function(a){switch(a.status){case 0:c="确定设置类目：@"+i+"为无效？",d.msg.msgbox.confirm(c,function(a){a&&k()});break;case 1:c="类目：@"+i+"下存在有效的子类目，不可设置为无效。<br />请问您确定要设置为无效？",d.msg.msgbox.confirm(c,function(a){a&&k()});break;case 2:c="类目：@"+i+"已绑定在售商品，不可设置为无效。<br/>请问您确定要设置为无效？",d.msg.msgbox.confirm(c,function(a){a&&k()})}}).fail(function(){d.msg.info(d.lang.exception)})},k=function(){b.post(f,{id:h}).done(function(a){d.issucceed(a)?(d.msg.suc(a.message),window.location.reload()):d.msg.error(a.message)}).fail(function(){d.msg.info(d.lang.exception)})};j()}),b(document).on("click",".js_invalid_status",function(){var a=b(this),c=b(".js_attr_name").val(),e=a.data("url"),f=function(){b.post(e,{name:c}).done(function(a){0!=a.status&&d.msg.error(a.message)}).fail(function(){d.msg.info(d.lang.exception)})};0!=c.length&&f()}),b(document).on("click",".js_import_file",function(){var a=b(this),c=b("#file_id"),e=c.find('input[type="file"][name="files"]'),f=c.find("span.fileinput-filename"),g=new FormData,h=e[0].files[0],i=a.data("url"),j=e.val();return j=j.toLowerCase(),g.append("file",h),0==j.length?void d.msg.info("请先选择excel文件!"):void("-1"!=j.indexOf("xls")||"-1"!=j.indexOf("xlsx")?b.ajax(i,{type:"post",data:g,dataType:"json",enctype:"multipart/form-data",processData:!1,contentType:!1}).done(function(a){0==a.status?(d.msg.info(a.message),window.location.reload()):d.msg.info(a.message)}).fail(function(){d.msg.info("网络异常")}):(f.text(""),e.val(""),c.find("a.fileinput-exists").trigger("click"),d.msg.info("您选择的文件格式不对,请选择xls或xlsx格式的文件,<br />请重新选择!")))}),b(document).on("click",'[data-toggle="ajaxRemove"]',function(a){a.preventDefault();{var c=b(this),e=c.data("remote")||c.attr("href"),f=c.data("confirm");c.data("remove")}f="undefined"==typeof f?!0:f;var g=function(){b.post(e).done(function(a){d.issucceed(a)?(d.msg.suc(a.message||d.lang.removeSuccess,a.url),window.location.reload()):d.msg.error(a.message||d.lang.removeError,a.url)}).fail(function(){d.msg.info(d.lang.exception)})};f&&d.msg.msgbox.confirm(c.data("msg")||d.lang.confirmRemove,function(a){a&&g()}),!f&&g()})});