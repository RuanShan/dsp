/*! weimob_vshop_admin
*author:<a.b.c@hd3p.com> */
define("dist/order/init",["$","dist/application/app","./courier"],function(a){"use strict";var b=a("$"),c=a("dist/application/app"),d=c.config,e=c.method;a("./courier");var f=0,g=null;b(document).on("click",'[data-toggle="download"]',function(){var a=b(this),c=a.closest("form"),h=a.data("set"),i=a.data("type")||"get",j=a.data("action"),k=b("#reportrange").val(),l=a.data("msg"),m=a.data("times");if(l)if(0>=f)if(clearInterval(g),f=m,g=setInterval(function(){f--},1e3),k){k=k.split("-");var n=new Date(k[0].replace("-","/").replace("-","/")),o=new Date(k[1].replace("-","/").replace("-","/")),p=(o-n)/864e5;if(c.length&&31>p){var q=c.serializeArray();q.push({name:"set",value:h}),e.OpenWindowWithPost(j||c.attr("action"),"_blank",q,i)}else d.msg.error("每次最多只能导出31天内的订单数据")}else d.msg.error("请选择日期每次最多只能导出31天内的订单数据");else d.msg.error(l.format(f));else if(k){k=k.split("-");var n=new Date(k[0].replace("-","/").replace("-","/")),o=new Date(k[1].replace("-","/").replace("-","/")),p=(o-n)/864e5;if(c.length&&31>p){var q=c.serializeArray();q.push({name:"set",value:h}),e.OpenWindowWithPost(j||c.attr("action"),"_blank",q,i)}else d.msg.error("每次最多只能导出31天内的订单数据")}else d.msg.error("请选择日期每次最多只能导出31天内的订单数据")}),b(document).on("click",".js_multy_dispatch",function(){var a=b(this),c=a.data("action"),d=a.data("type")||"post",f=a.data("set"),g=[];g.push({name:"ids",value:f.ids}),e.OpenWindowWithPost(c,"_blank",g,d)}),b(document).on("keyup",".js_price_input",function(){var a=b(".js_total"),c=b(".js_total_show"),d=0;b(this).hasClass("error")||(b(".js_price_input").each(function(){d+=(b(this).val()||0)-0}),a.val(d.toFixed(2)),c.html(d.toFixed(2)))}),b(document).on("shown.bs.tab",".js_shipments_select_tab a[data-toggle='tab']",function(a){var c=b(a.target),d=c.data("type"),e=c.closest("form");b(".js_shipments_select",e).val(d)})}),define("dist/order/courier",["$","dist/application/app"],function(a){"use strict";var b=a("$"),c=a("dist/application/app"),e=c.config;b(document).on("change",".js_tip_type",function(){var a=b(this).data("val");b(".js_other,.js_ck").attr("disabled","disabled"),a&&b(".js_other,.js_ck").removeAttr("disabled")}),b(document).on("click",".js_remark_del",function(a){a.preventDefault();var c=b(this),f=c.data("remote")||c.attr("href"),g=c.data("confirm");g="undefined"==typeof g?!0:g;var h=function(){var a=c.html();c.html('<i class="fa fa-spinner fa-spin"></i>'),b.post(f).done(function(b){if(e.issucceed(b)){e.msg.suc(b.message||e.lang.removeSuccess,b.url);var d=c.parents("div.form-group");d.fadeOut(function(){d.remove()})}else c.html(a),e.msg.error(b.message||e.lang.removeError,b.url)}).fail(function(){c.html(a),e.msg.info(e.lang.exception,d.url)})};g&&e.msg.msgbox.confirm(c.data("msg")||e.lang.confirmRemove,function(a){a&&h()}),!g&&h()})});