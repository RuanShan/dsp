/*! weimob_vshop_admin
*author:<a.b.c@hd3p.com> */
define("dist/goodsajax/init",["$","dist/application/app","./goodsajax","./template/ajaxPage.html","./template/goodsajaxdistribution.html","./template/goodsajaxnewest.html","./template/ajaxPageNew.html","./template/goodsajaxnewest2.html","./template/goodsajaxnewest3.html","./template/goodsajax.html"],function(a){"use strict";{var b=(a("$"),a("dist/application/app"));b.config}a("./goodsajax")}),define("dist/goodsajax/goodsajax",["$","dist/application/app"],function(a){"use strict";function b(a,b){h.post(a,function(a){if(g.issucceed(a)){var b=a.data.data,c=[],d=a.data.totalPage,f=a.data.currentPage;if(b){for(var h=0,i=b.length;i>h;h++)e.inArray(b[h].id,window.freeship_data.goods)>-1&&(b[h].checked=!0);if(d>0)if(d-f>=2){var n=1,o=5;n=f-2>0?f-2:1,o=n+4;for(var h=n;o>=h;h++)h>0&&d>=h&&c.push(h)}else{var n=1,o=5;o=d>=f+2?f+2:d,n=o-4;for(var h=n;o>=h;h++)h>0&&d>=h&&c.push(h)}}a.data.pagelist=c,a.data.selected=m.hasClass(k);var p=window.good_url;if(0==b.length&&p)var q='<a class="text-blue" href='+p+">您暂无任何商品，请添加商品</a>";else var q=template.compile(j+l)(a.data);if(m.html(q),!m.hasClass(k)){var i=e(".list-goods li",m).length,r=e(".list-goods li.selected",m).length,s=e(".list-goods li.disabled",m).length;i==r+s&&e(".js_page_goods",m).prop("checked",!0)}}else g.msg.error(a.message)},g.lang.exception,!1,b)}function c(a,b,c){if(c){var d=e.inArray(a,b);d>-1&&b.splice(d,1)}else b.push(a);b.length>0?(o.length>0&&o.val(window.freeship_data.goods),p.length>0&&p.html(b.length)):(o.length>0&&o.val(""),p.length>0&&p.html(0))}function d(a){var b=(e("#goods_select_type"),a.data("type")),c=e(".js_type_goods_div");c.addClass("hide"),e(".js_type_goods_"+b).removeClass("hide"),e("#goods_select_type").val(a.val())}var e=a("$"),f=a("dist/application/app"),g=f.config,h=f.method,i=e('[data-id="putaway"]'),j="",k="",l=a("dist/goodsajax/template/ajaxPage.html");window.freeship_data.type&&"distribution"==window.freeship_data.type?j=a("dist/goodsajax/template/goodsajaxdistribution.html"):window.freeship_data.type&&"newest"==window.freeship_data.type?(j=a("dist/goodsajax/template/goodsajaxnewest.html"),l=a("dist/goodsajax/template/ajaxPageNew.html"),k="newest-selected"):window.freeship_data.type&&"newest2"==window.freeship_data.type?(j=a("dist/goodsajax/template/goodsajaxnewest2.html"),l=a("dist/goodsajax/template/ajaxPageNew.html"),k="newest-selected"):window.freeship_data.type&&"newest3"==window.freeship_data.type?(j=a("dist/goodsajax/template/goodsajaxnewest3.html"),k="newest-selected"):j=a("dist/goodsajax/template/goodsajax.html");var m=e("#goods_show"),n=e("#putaway form").serialize(),o=e("#goods_select_input"),p=e(".js_goods_count");i.length>0&&b(i.data("path"),n),e('a[data-toggle="tab"]').on("show.bs.tab",function(){m.html('<i class="fa fa-spinner fa-spin"></i>')}),e('a[data-toggle="tab"]').on("shown.bs.tab",function(a){{var c=e(a.target),d=c.data("path"),f=c.data("id"),g=e("#"+f+" form").serialize(),h=e("div.tab-pane.active");e(".js_page_goods",h)}"selected"==f?(g+="&ids="+window.freeship_data.goods,m.addClass(k),b(d,g)):(m.removeClass(k),b(d,g))}),e(document).on("click",".list-goods li",function(){var a=e(this),b=a.hasClass("selected"),d=a.hasClass("disabled"),f=a.data("id")+"",g=e("div.tab-pane.active"),h=e(".js_page_goods",g);d||(b?(a.removeClass("selected"),h.prop("checked",!1),m.hasClass(k),c(f,window.freeship_data.goods,!0)):(a.addClass("selected"),c(f,window.freeship_data.goods,!1)))}),e(document).on("click",".js_page_goods",function(){var a=e(this),b=a.prop("checked"),d=m.find(".list-goods li");d.each(b?function(){var a=e(this),b=a.data("id")+"",d=a.hasClass("disabled");d||a.hasClass("selected")||(a.addClass("selected"),c(b,window.freeship_data.goods,!1))}:function(){var a=e(this),b=a.data("id")+"",d=a.hasClass("disabled");!d&&a.hasClass("selected")&&(a.removeClass("selected"),c(b,window.freeship_data.goods,!0))})}),e(document).on("click","button[data-type='order']",function(){var a=e(this),c=a.closest("form"),d=e(a.data("order"),c),f=e(a.data("orderField"),c),g=d.val(),h=(f.val(),a.data("field")),i=e("button[data-type='order']",c),j=i.find("i"),k=a.find("i"),l=c.data("path"),m=e(".js_page_goods",c),n=e(".js_page",c);switch(i.removeClass("btn-danger"),j.addClass("fa-arrows-v").removeClass("fa-long-arrow-down fa-long-arrow-up"),f.val(h),n.val(1),m.prop("checked",!1),a.addClass("btn-danger"),g){case"desc":d.val("asc"),k.addClass("fa-long-arrow-up").removeClass("fa-arrows-v");break;case"asc":d.val("desc"),k.addClass("fa-long-arrow-down").removeClass("fa-arrows-v");break;default:d.val("desc"),k.addClass("fa-long-arrow-down").removeClass("fa-arrows-v")}var o=c.serialize();b(l,o)}),e(document).on("click","button[data-type='ajaxSearch']",function(){var a=e(this),c=a.closest("form"),d=c.data("path"),f=e(".js_page_goods",c),g=e(".js_page",c);g.val(1),f.prop("checked",!1);var h=c.serialize();b(d,h)}),e(document).on("change","select[data-type='ajaxSelectSearch']",function(){var a=e(this),c=a.closest("form"),d=c.data("path"),f=e(".js_page_goods",c),i=e(".js_page",c),j=a.data("path");if(i.val(1),f.prop("checked",!1),a.hasClass("js_search_select_type_select")){var k=a.find("option:selected").data("type");e(".js_search_select_type",c).addClass("hide").prop("disabled",!0).find("option").removeAttr("selected"),e(".js_search_select_type_"+k,c).removeClass("hide").prop("disabled",!1)}if(j){var l=e(a.data("target"));l.empty(),l.append(e("<option/>").attr("value","").text("全部")),h.post(j,function(a){var b="";e.each(a,function(a,c){b+="<option value="+c.value+">"+c.title+"</option>"}),l.append(b)},g.lang.exception,!1,{value:a.val()})}var m=c.serialize();b(d,m)}),e(document).on("click","footer[data-type='ajaxPage'] a",function(){var a=e(this),c=a.closest("li"),d=c.hasClass("disabled"),f=c.hasClass("active"),g=e("div.tab-pane.active"),h=g.attr("id"),i=g.find("form"),j=i.data("path"),k=e(".js_page_goods",i),l=e(".js_page",i),m=a.data("pageNum");if(!d&&!f){l.val(m),e("footer[data-type='ajaxPage'] li.active").removeClass("active"),c.addClass("active"),k.prop("checked",!1);var n=i.serialize();"selected"==h&&(n+="&ids="+window.freeship_data.goods),b(j,n)}}),e(document).on("click",".js_goods_submit_btn",function(){return o.length>0&&o.val().length<1?(g.msg.error("请选择商品"),!1):void 0}),e(document).on("click",".js_goods_submit_btn_sb",function(){var a=e("input.js_goods_type:checked").data("val");return o.length>0&&o.val().length<1&&0==a?(g.msg.error("请选择商品"),!1):void 0}),e(document).on("click",".js_goods_submit_part",function(){return o.length>0&&o.val().length<1&&!e(".js_party_goods").hasClass("hide")?(g.msg.error("请选择商品"),!1):void 0}),e(document).on("keypress",function(a){var a=a||event,b=a.keyCode||a.which||a.charCode;return 13==b?(e("div.tab-pane.active button[data-type='ajaxSearch']").trigger("click"),!1):void 0}),e(document).on("click",".js_goods_type_select input[type='radio']",function(){d(e(this))});var q=e(".js_goods_type_select input[type='radio']:checked");q.length&&function(){d(q)}()}),define("dist/goodsajax/template/ajaxPage.html",[],'{{if count>0}}\n<footer class="footer bg-white b-t" data-type="ajaxPage">\n  <div class="row text-center-xs">\n      <div class="col-md-6 hidden-sm">\n          <p class="text-muted m-t">总共{{count}}条 当前为第{{currentPage}}页</p>\n      </div>\n      <div class="col-md-6 col-sm-12 text-right text-center-xs">\n          <ul class="pagination pagination-sm m-t-sm m-b-none" data-apages-total="{{totalPage}}" data-apage-current="{{currentPage}}">\n\n            <li {{if currentPage==1}} class="disabled"{{/if}}>\n              <a href="javascript:;" rel="first" data-page-num="1"><i class="fa fa-angle-double-left" title="第一页"></i></a>\n            </li>\n            <li {{if currentPage==1}} class="disabled"{{/if}}>\n              <a href="javascript:;" rel="prev" data-page-num="{{currentPage-1}}"><i class="fa fa-angle-left" title="上一页"></i></a>\n            </li>\n            {{each pagelist as item}}\n              <li {{if currentPage==item}} class="active"{{/if}}>\n                <a href="javascript:;" data-page-num="{{item}}" data-page-isnum="true">{{item}}</a>\n              </li>\n            {{/each}}\n            <li {{if currentPage==totalPage}} class="disabled"{{/if}}><a href="javascript:;" rel="next" data-page-num="{{currentPage+1}}"><i class="fa fa-angle-right" title="下一页"></i></a></li>\n            <li {{if currentPage==totalPage}} class="disabled"{{/if}}><a href="javascript:;" rel="last" data-page-num="{{totalPage}}"><i class="fa fa-angle-double-right" title="最后页" ></i></a></li>\n          </ul>\n      </div>\n  </div>\n</footer>\n{{/if}}'),define("dist/goodsajax/template/goodsajaxdistribution.html",[],'{{if data}}\n  <ul class="list-goods list-unstyled clearfix">\n  {{each data as item}}\n    <li data-id="{{item.id}}" class="{{if item.checked}}selected{{/if}}" >\n        <div class="pull-left">\n          <img src="{{item.img}}">\n        </div>\n        <div class="pull-left m-t">\n          <div class="goods-name" title="{{item.name}}">{{item.name}}</div>\n          <div class="goods-label">\n           \n          </div>\n          <div class="clearfix">\n            <div class="pull-left goods-price">￥{{item.price}}</div>\n          </div>\n        </div>\n        <span class="selected-sign"></span>\n    </li>\n  {{/each}}\n \n  </ul>\n{{else}}\n<div>暂无数据</div>\n{{/if}}\n\n'),define("dist/goodsajax/template/goodsajaxnewest.html",[],'{{if data}}\n  <ul class="list-goods list-unstyled clearfix list-goods-newest">\n  {{each data as item}}\n    <li data-id="{{item.id}}" class="{{if item.checked}}selected{{/if}}  {{if item.msg!=\'\'}}disabled{{/if}}" >\n        <div class="pull-left">\n          <img src="{{item.img}}">\n        </div>\n        <div class="pull-left">\n          <div class="goods-name-new" title="{{item.name}}">{{item.name}}</div>\n          <div class="goods-label-new">\n            {{item.msg}}\n          </div>\n          <div class="clearfix">\n            <div class="pull-left goods-price" style="width:80px">￥{{item.price}}</div>\n            <div class="pull-left goods-count" style="width:80px">库存：{{item.store}}</div>\n          </div>\n        </div>\n        <span class="selected-sign"></span>\n    </li>\n  {{/each}}\n \n  </ul>\n{{else}}\n<div>暂无数据</div>\n{{/if}}\n\n'),define("dist/goodsajax/template/ajaxPageNew.html",[],'<footer class="footer bg-white b-t" data-type="ajaxPage">\n  <div class="row text-center-xs">\n      <div class="col-md-2 hidden-sm">\n        <div class="text-muted" style="margin-top:8px">\n          {{if !selected}}\n          <label class="checkbox-inline">\n            <input type="checkbox" class="js_page_goods" />        \n            选择本页\n          </label>\n          {{/if}}\n          <!--{{if count>0}} \n          <label class="checkbox-inline">\n            总共{{count}}条 当前为第{{currentPage}}页\n          </label>\n          {{/if}} -->\n        </div>\n      </div>\n      {{if count>0}}\n      <div class="col-md-10 col-sm-12 text-right text-center-xs">\n\n          <ul class="pagination pagination-sm m-t-sm m-b-none pull-right" data-apages-total="{{totalPage}}" data-apage-current="{{currentPage}}">\n\n            <li {{if currentPage==1}} class="disabled"{{/if}}>\n              <a href="javascript:;" rel="first" data-page-num="1"><i class="fa fa-angle-double-left" title="第一页"></i></a>\n            </li>\n            <li {{if currentPage==1}} class="disabled"{{/if}}>\n              <a href="javascript:;" rel="prev" data-page-num="{{currentPage-1}}"><i class="fa fa-angle-left" title="上一页"></i></a>\n            </li>\n            {{each pagelist as item}}\n              <li {{if currentPage==item}} class="active"{{/if}}>\n                <a href="javascript:;" data-page-num="{{item}}" data-page-isnum="true">{{item}}</a>\n              </li>\n            {{/each}}\n            <li {{if currentPage==totalPage}} class="disabled"{{/if}}><a href="javascript:;" rel="next" data-page-num="{{currentPage+1}}"><i class="fa fa-angle-right" title="下一页"></i></a></li>\n            <li {{if currentPage==totalPage}} class="disabled"{{/if}}><a href="javascript:;" rel="last" data-page-num="{{totalPage}}"><i class="fa fa-angle-double-right" title="最后页" ></i></a></li>\n          </ul>\n          <span class="pull-right text-muted m-r-sm" style="margin-top:15px">总共{{count}}条 当前为第{{currentPage}}页</span>\n      </div>\n      {{/if}}\n  </div>\n</footer>'),define("dist/goodsajax/template/goodsajaxnewest2.html",[],'{{if data}}\n  <ul class="list-goods list-unstyled clearfix list-goods-newest">\n  {{each data as item}}\n    <li data-id="{{item.id}}" class="{{if item.checked}}selected{{/if}}  {{if item.msg!=\'\'}}disabled{{/if}}" >\n        <div class="pull-left">\n          <img src="{{item.img}}">\n        </div>\n        <div class="pull-left">\n          <div class="goods-name-new" title="{{item.name}}">{{item.name}}</div>\n          <div class="goods-label-new">\n            \n          </div>\n          <div class="clearfix">\n            <div class="pull-left goods-price" style="width:80px">￥{{item.price}}</div>\n          </div>\n        </div>\n        <span class="selected-sign"></span>\n    </li>\n  {{/each}}\n \n  </ul>\n{{else}}\n<div>暂无数据</div>\n{{/if}}\n\n'),define("dist/goodsajax/template/goodsajaxnewest3.html",[],'{{if data}}\n  <ul class="list-goods list-unstyled clearfix list-goods-newest">\n  {{each data as item}}\n    <li data-id="{{item.id}}" class="disabled" >\n        <div class="pull-left">\n          <img src="{{item.img}}">\n        </div>\n        <div class="pull-left">\n          <div class="goods-name-new" title="{{item.name}}">{{item.name}}</div>\n          <div class="goods-label-new">\n            \n          </div>\n          <div class="clearfix">\n            <div class="pull-left goods-price" style="width:80px">￥{{item.price}}</div>\n          </div>\n        </div>\n        <span class="selected-sign"></span>\n    </li>\n  {{/each}}\n \n  </ul>\n{{else}}\n<div>暂无数据</div>\n{{/if}}\n\n'),define("dist/goodsajax/template/goodsajax.html",[],'{{if data}}\n  <ul class="list-goods list-unstyled clearfix">\n  {{each data as item}}\n    <li data-id="{{item.id}}" class="{{if item.checked}}selected{{/if}}  {{if item.store==0}}disabled{{/if}}" >\n        <div class="pull-left">\n          <img src="{{item.img}}">\n        </div>\n        <div class="pull-left m-t">\n          <div class="goods-name" title="{{item.name}}">{{item.name}}</div>\n          <div class="goods-label">\n            {{each item.label as text}}\n              <span class="label label-danger">{{text}}</span>\n            {{/each}}\n          </div>\n          <div class="clearfix">\n            <div class="pull-left goods-price">￥{{item.price}}</div>\n            <div class="pull-left goods-count">库存{{item.store}}</div>\n          </div>\n        </div>\n        <span class="selected-sign"></span>\n    </li>\n  {{/each}}\n \n  </ul>\n{{else}}\n<div>暂无数据</div>\n{{/if}}\n\n');