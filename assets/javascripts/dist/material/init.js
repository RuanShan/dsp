/*! weimob_vshop_admin
*author:<a.b.c@hd3p.com> */
define("dist/material/init",["$","dist/application/app","jquery_ui"],function(a){"use strict";function b(){var a=c(".js_style:checked").data("val"),b=c(".js_style1").data("url"),d=c(".js_tem_list li img");if(a){if(c(".js_style1").addClass("hide"),c(".js_style2").removeClass("hide"),c(".js_style2").empty(),0==d.length)for(var e=0;2>e;e++){var f={};f.imgsrc=b;var g=template("style_img",f);c(".js_style2").append(g)}}else c(".js_style1").removeClass("hide"),c(".js_style2").addClass("hide"),c(".js_style1").find("img").attr("src",b);d.length>0&&d.each(function(b){var d=c(this).attr("src");if(a){var e={};e.imgsrc=d;var f=template("style_img",e);c(".js_style2").append(f)}else{var g=c(".js_style1").find("img");g.each(function(a){a==b&&c(this).attr("src",d)})}})}{var c=a("$"),d=a("dist/application/app"),e=d.config;d.method}a("jquery_ui"),c(document).on("click",'button[data-toggle="toDetail"]',function(a){a&&a.preventDefault();var b=c(this),d=b.closest(".modal-content").find("input:checked").data("url");d&&(window.location=d)}),c("ul.ipost-list",".brandInfo").sortable({opacity:.8,stop:function(){b()}}),c(document).on("click","a.js_del",function(){c(this).closest("li").fadeOut("fast",function(){c(this).remove(),c.each(c(".ipost-list li").not(".js_add_tmp"),function(a,b){c(b).find('input[type="hidden"]').eq(0).attr("name","brand["+a+"][name]"),c(b).find('input[type="hidden"]').eq(1).attr("name","brand["+a+"][url]"),c(b).find('input[type="hidden"]').eq(2).attr("name","brand["+a+"][type]"),c(b).find('input[type="hidden"]').eq(3).attr("name","brand["+a+"][shop]"),c(b).find('input[type="hidden"]').eq(4).attr("name","brand["+a+"][shop2]")}),b()})}),c(document).on("click",".js_modal .js_add_brand",function(){for(var a=c(this),d=a.closest("form").valid(),f=a.data("url"),g=c(".js_shop").val(),h=0;h<c(".condition").length;h++)if("checked"==c(".condition:eq("+h+")").attr("checked")){var i=h,j=c("#pb_xz_"+h).val();if(2==h)var k=c("#pb_xz_"+h+"1 select").val();else var k=""}if(d){if(0==c(".js_modal .thumb_img").length||0==c(".js_modal .thumb_img").attr("src").length)return;c.ajax({url:f,type:"get",dataType:"json",data:{id:g}}).done(function(d){if(0!=d.status)return void e.msg.info(d.message);{var f=template("brand_img_tmp",{url:c(".js_modal .thumb_img").attr("src"),name:c(".js_modal .js_brand").val(),shop:j,shop2:k,type:i,size:c(".ipost-list li").not(".js_add_tmp").length}),g=c(".js_tem_list li");g.length}c(".js_add_tmp").before(f),a.closest(".modal").modal("hide"),b()}).fail(function(){e.msg.info("网络异常")})}}),c(document).on("change",".js_subject_type",function(){{var a=c(this),b=String(a.val()),d=a.data("id").split(","),f=c(".js_subjects"),g=c('<select class="form-control" name="subject"></select>'),h=window.subjectUrl;a.closest("form")}if(h=h+"?type="+b,0==b.length)return void f.empty();for(var i=0;i<d.length;i++)if(b==d[i])return void f.empty();c.ajax({url:h,type:"get",dataType:"json"}).done(function(a){if(0==a.status){var b=a.data;f.empty(),g.append('<option value="">请选择专题</option>'),c.each(b,function(a,b){var c=template("delivery_city_tem",b);g.append(c)}),f.append(g)}else e.msg.info(a.message)}).fail(function(){e.msg.info("网络异常")})}),c(document).on("click","input.condition",function(){{var a=c(this),b=c("input.condition").closest(".form-group");a.prop("checked")}b.find('input[type="text"], select').attr("disabled","disabled"),a.closest(".form-group").find('input[type="text"], select').removeAttr("disabled")}),c(document).on("click","input.condition2",function(){var a=c(this),b=a.closest(".form-group"),d=a.prop("checked");d?b.find("select").removeAttr("disabled"):b.find("select").attr("disabled","disabled")}),c(".px_bj").on("click",function(){var a=c(this).attr("data-bj"),b=c(this).parent();if(0==a){c(this).attr("data-bj",1),b.children(".showmx").hide();var d=b.children(".showmx").html();b.children(".showmxing").val(d).show(),c(this).children(".fa-edit").hide(),c(this).children(".fa-check").show()}else{c(this).attr("data-bj",0),b.children(".showmxing").hide();var d=b.children(".showmxing").val();b.children(".showmx").html(d).show(),c(this).children(".fa-edit").show(),c(this).children(".fa-check").hide();var f=c(this).parent().children(".idname").html(),g=window.SETNUMBER,h={};h.number=d,h.idname=f,c.ajax({url:g,type:"post",data:h,dataType:"json"}).done(function(a){window.location.href=a.url}).fail(function(){e.msg.info("网络异常")})}}),b(),c(document).on("change",".js_style",function(){b()})});