/*! weimob_vshop_admin
*author:<a.b.c@hd3p.com> */
define("dist/sys_msg/init",["$","dist/application/app"],function(a){"use strict";{var b=a("$"),c=a("dist/application/app"),d=c.config;c.method}b(".form-control-static").click(function(){b(this).hasClass("open")?(b(this).removeClass("open"),b(this).find("i").removeClass("fa-angle-up").addClass("fa-angle-down"),b(this).next().slideUp(300)):(b(this).addClass("open"),b(this).find("i").removeClass("fa-angle-down").addClass("fa-angle-up"),b(this).next().slideDown(300),b(this).closest(".padding-left").siblings().find(".form-control-static").removeClass("open"),b(this).closest(".padding-left").siblings().find(".content").slideUp(300),b(this).closest(".padding-left").siblings().find("i").removeClass("fa-angle-up").addClass("fa-angle-down"));var a=b(this).data("cid");if(b(this).hasClass("black")){var c={};c.cid=a,b.ajax({type:"POST",url:window.msg_path,data:c,dataType:"json"})}b(this).removeClass("black")}),b(".form-control-static").on("click",function(){if(!b(this).hasClass("opened")){var a=b(this).data("path"),c=b(this).parents("div.form-group").data("cid"),e=b(this).parents("div.form-group").find("em.letter_sign"),f=b(this).parents("section.wrapper").find("ul.nav li.active span"),g=parseFloat(f.html().substring(1,f.html().length-1));b.post(a,{id:c}).done(function(a){d.issucceed(a)?(e.removeClass("text-danger"),g>0&&g--,f.html("("+g+")"),0==g?(f.removeClass("text-danger"),f.addClass("text-muted")):(f.removeClass("text-muted"),f.addClass("text-danger"))):d.msg.error(a.message)}).fail(function(){d.msg.info(d.lang.exception)})}b(this).addClass("opened"),b(this).parent().children(".m-t-sm").addClass("opened")}),b(document).on("click",".js_all_read",function(){var a=b(this).data("id"),c=b(this).data("remote"),e=b(this).parents("div.js_lett").find(".js_read_show em.letter_sign"),f=b(this).parents("section.wrapper").find("ul.nav li.active span");b.post(c,{id:a}).done(function(a){d.issucceed(a)?(d.msg.suc(a.message),e.removeClass("text-danger"),f.html("("+a.number+")"),0==a.number?(f.removeClass("text-danger"),f.addClass("text-muted")):(f.removeClass("text-muted"),f.addClass("text-danger"))):d.msg.error(a.message)}).fail(function(){d.msg.info(d.lang.exception)})}),b(document).on("click",".js_mess_read",function(a){var c=b(this).parents("div.form-group").data("cid"),e=window.msg_paths,f=b(this).parents("div.form-group").find("em.letter_sign"),g=b(this).parents("section.wrapper").find("ul.nav li.active span"),h=parseFloat(g.html().substring(1,g.html().length-1));f.hasClass("text-danger")&&(a.preventDefault(),b.post(e,{id:c}).done(function(a){d.issucceed(a)?(f.removeClass("text-danger"),h>0&&h--,g.html("("+h+")"),0==h?(g.removeClass("text-danger"),g.addClass("text-muted")):(g.removeClass("text-muted"),g.addClass("text-danger")),a.url&&(window.location=a.url)):d.msg.error(a.message)}).fail(function(){d.msg.info(d.lang.exception)}))})});