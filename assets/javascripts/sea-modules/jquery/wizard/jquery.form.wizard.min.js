define(function(c,b,a){var d=c("jquery");(function(f){f.widget("ui.formwizard",{_init:function(){var g=this,k=this.options.formOptions.error,m=this.options.formOptions.success,j=this.options.formOptions.complete,e=this.options.formOptions.beforeSend,h=this.options.formOptions.beforeSubmit,l=this.options.formOptions.beforeSerialize;this.options.formOptions=f.extend(this.options.formOptions,{success:function(p,o,n){m&&m(p,o,n);(g.options.formOptions&&g.options.formOptions.resetForm||!g.options.formOptions)&&g._reset();g._enableNavigation()},error:function(p,o,n){k&&k(p,o,n);g._enableNavigation()},complete:function(i,o){j&&j(i,o)},beforeSubmit:function(q,s,p){if(h){var o=h(q,s,p);o||g._enableNavigation();return o}},beforeSend:function(i){if(e){var o=e(i);return o}},beforeSerialize:function(o,p){if(l){var i=l(o,p);return i}}});this.options.historyEnabled&&f.bbq.removeState("_"+f(this.element).attr("id"));this.steps=this.element.find(".step").hide();this.firstStep=this.steps.eq(0).attr("id");this.activatedSteps=new Array;this.isLastStep=!1;this.previousStep=undefined;this.currentStep=this.steps.eq(0).attr("id");this.nextButton=this.element.find(this.options.next).click(function(){return g._next()});this.nextButtonInitinalValue=this.nextButton.val();this.nextButton.val(this.options.textNext);this.backButton=this.element.find(this.options.back).click(function(){g._back();return !1});this.backButtonInitinalValue=this.backButton.val();this.backButton.val(this.options.textBack);if(this.options.validationEnabled&&d().validate==undefined){this.options.validationEnabled=!1;window.console!==undefined&&console.log("%s","validationEnabled option set, but the validation plugin is not included")}else{this.options.validationEnabled&&this.element.validate(this.options.validationOptions)}if(this.options.formPluginEnabled&&d().ajaxSubmit==undefined){this.options.formPluginEnabled=!1;window.console!==undefined&&console.log("%s","formPluginEnabled option set but the form plugin is not included")}this.options.disableInputFields==1&&f(this.steps).find(":input:not('.wizard-ignore')").attr("disabled","disabled");this.options.historyEnabled&&f(window).bind("hashchange",undefined,function(o){var i=o.getState("_"+f(g.element).attr("id"))||g.firstStep;if(i!==g.currentStep){if(g.options.validationEnabled&&i===g._navigate(g.currentStep)&&!g.element.valid()){g._updateHistory(g.currentStep);g.element.validate().focusInvalid();return !1}i!==g.currentStep&&g._show(i)}});this.element.addClass("ui-formwizard");this.element.find(":input").addClass("ui-wizard-content");this.steps.addClass("ui-formwizard-content");this.backButton.addClass("ui-formwizard-button ui-wizard-content");this.nextButton.addClass("ui-formwizard-button ui-wizard-content");if(!this.options.disableUIStyles){this.element.addClass("ui-helper-reset ui-widget ui-widget-content ui-helper-reset ui-corner-all");this.element.find(":input").addClass("ui-helper-reset ui-state-default");this.steps.addClass("ui-helper-reset ui-corner-all");this.backButton.addClass("ui-helper-reset ui-state-default");this.nextButton.addClass("ui-helper-reset ui-state-default")}this._show(undefined);return f(this)},_next:function(){if(this.options.validationEnabled&&!this.element.valid()){this.element.validate().focusInvalid();return !1}if(this.options.remoteAjax!=undefined){var g=this.options.remoteAjax[this.currentStep],k=this;if(g!==undefined){var j=g.success,e=g.beforeSend,h=g.complete;g=f.extend({},g,{success:function(l,i){(j!==undefined&&j(l,i)||j==undefined)&&k._continueToNextStep()},beforeSend:function(i){k._disableNavigation();e!==undefined&&e(i);f(k.element).trigger("before_remote_ajax",{currentStep:k.currentStep})},complete:function(i,l){h!==undefined&&h(i,l);f(k.element).trigger("after_remote_ajax",{currentStep:k.currentStep});k._enableNavigation()}});this.element.ajaxSubmit(g);return !1}}return this._continueToNextStep()},_back:function(){this.activatedSteps.length>0&&(this.options.historyEnabled?this._updateHistory(this.activatedSteps[this.activatedSteps.length-2]):this._show(this.activatedSteps[this.activatedSteps.length-2],!0));return !1},_continueToNextStep:function(){if(this.isLastStep){for(var h=0;h<this.activatedSteps.length;h++){this.steps.filter("#"+this.activatedSteps[h]).find(":input").not(".wizard-ignore").removeAttr("disabled")}if(!this.options.formPluginEnabled){return !0}this._disableNavigation();this.element.ajaxSubmit(this.options.formOptions);return !1}var g=this._navigate(this.currentStep);if(g==this.currentStep){return !1}this.options.historyEnabled?this._updateHistory(g):this._show(g,!0);return !1},_updateHistory:function(e){var g={};g["_"+f(this.element).attr("id")]=e;f.bbq.pushState(g)},_disableNavigation:function(){this.nextButton.attr("disabled","disabled");this.backButton.attr("disabled","disabled");if(!this.options.disableUIStyles){this.nextButton.removeClass("ui-state-active").addClass("ui-state-disabled");this.backButton.removeClass("ui-state-active").addClass("ui-state-disabled")}},_enableNavigation:function(){this.isLastStep?this.nextButton.val(this.options.textSubmit):this.nextButton.val(this.options.textNext);this.isLastStep?f("."+this.options.otherClass).show():f("."+this.options.otherClass).hide();if(f.trim(this.currentStep)!==this.steps.eq(0).attr("id")){this.backButton.removeAttr("disabled");this.options.disableUIStyles||this.backButton.removeClass("ui-state-disabled").addClass("ui-state-active")}this.nextButton.removeAttr("disabled");this.options.disableUIStyles||this.nextButton.removeClass("ui-state-disabled").addClass("ui-state-active")},_animate:function(l,h,m){this._disableNavigation();var k=this.steps.filter("#"+l),g=this.steps.filter("#"+h);k.find(":input").not(".wizard-ignore").attr("disabled","disabled");g.find(":input").not(".wizard-ignore").removeAttr("disabled");var j=this;k.animate(j.options.outAnimation,j.options.outDuration,j.options.easing,function(){g.animate(j.options.inAnimation,j.options.inDuration,j.options.easing,function(){j.options.focusFirstInput&&g.find(":input:first").focus();j._enableNavigation();m.apply(j)});return})},_checkIflastStep:function(e){this.isLastStep=!1;if(f("#"+e).hasClass(this.options.submitStepClass)||this.steps.filter(":last").attr("id")==e){this.isLastStep=!0}},_getLink:function(e){var h=undefined,g=this.steps.filter("#"+e).find(this.options.linkClass);g!=undefined&&(g.filter(":radio,:checkbox").size()>0?h=g.filter(this.options.linkClass+":checked").val():h=f(g).val());return h},_navigate:function(h){var g=this._getLink(h);if(g!=undefined){return g!=""&&g!=null&&g!=undefined&&this.steps.filter("#"+g).attr("id")!=undefined?g:this.currentStep}if(g==undefined&&!this.isLastStep){var i=this.steps.filter("#"+h).next().attr("id");return i}},_show:function(g){var j=!1,h=g!==undefined;if(g==undefined||g==""){this.activatedSteps.pop();g=this.firstStep;this.activatedSteps.push(g)}else{if(f.inArray(g,this.activatedSteps)>-1){j=!0;this.activatedSteps.pop()}else{this.activatedSteps.push(g)}}if(this.currentStep!==g||g===this.firstStep){this.previousStep=this.currentStep;this._checkIflastStep(g);this.currentStep=g;var e=function(){h&&f(this.element).trigger("step_shown",f.extend({isBackNavigation:j},this._state()))};h&&f(this.element).trigger("before_step_shown",f.extend({isBackNavigation:j},this._state()));this._animate(this.previousStep,g,e)}},_reset:function(){this.element.resetForm();f("label,:input,textarea",this).removeClass("error");for(var e=0;e<this.activatedSteps.length;e++){this.steps.filter("#"+this.activatedSteps[e]).hide().find(":input").attr("disabled","disabled")}this.activatedSteps=new Array;this.previousStep=undefined;this.isLastStep=!1;this.options.historyEnabled?this._updateHistory(this.firstStep):this._show(this.firstStep)},_state:function(h){var g={settings:this.options,activatedSteps:this.activatedSteps,isLastStep:this.isLastStep,isFirstStep:this.currentStep===this.firstStep,previousStep:this.previousStep,currentStep:this.currentStep,backButton:this.backButton,nextButton:this.nextButton,steps:this.steps,firstStep:this.firstStep};return h!==undefined?g[h]:g},show:function(g){this.options.historyEnabled?this._updateHistory(g):this._show(g)},state:function(g){return this._state(g)},reset:function(){this._reset()},next:function(){this._next()},back:function(){this._back()},destroy:function(){this.element.find("*").removeAttr("disabled").show();this.nextButton.unbind("click").val(this.nextButtonInitinalValue).removeClass("ui-state-disabled").addClass("ui-state-active");this.backButton.unbind("click").val(this.backButtonInitinalValue).removeClass("ui-state-disabled").addClass("ui-state-active");this.backButtonInitinalValue=undefined;this.nextButtonInitinalValue=undefined;this.activatedSteps=undefined;this.previousStep=undefined;this.currentStep=undefined;this.isLastStep=undefined;this.options=undefined;this.nextButton=undefined;this.backButton=undefined;this.formwizard=undefined;this.element=undefined;this.steps=undefined;this.firstStep=undefined},update_steps:function(){this.steps=this.element.find(".step").addClass("ui-formwizard-content");this.firstStep=this.steps.eq(0).attr("id");this.steps.not("#"+this.currentStep).hide().find(":input").addClass("ui-wizard-content").attr("disabled","disabled");this._checkIflastStep(this.currentStep);this._enableNavigation();if(!this.options.disableUIStyles){this.steps.addClass("ui-helper-reset ui-corner-all");this.steps.find(":input").addClass("ui-helper-reset ui-state-default")}},options:{historyEnabled:!1,validationEnabled:!1,validationOptions:undefined,formPluginEnabled:!1,linkClass:".link",submitStepClass:"submit_step",back:":reset",next:":submit",otherClass:"other_css",textSubmit:"提交",textNext:"下一步",textBack:"后退",remoteAjax:undefined,inAnimation:{opacity:"show"},outAnimation:{opacity:"hide"},inDuration:400,outDuration:400,easing:"swing",focusFirstInput:!1,disableInputFields:!0,formOptions:{reset:!0,success:function(g){window.console!==undefined&&console.log("%s","form submit successful")},disableUIStyles:!1}}})})(d)});
;

;
